<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>San Valent√≠n Espacial</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&amp;family=Playfair+Display:wght@400;600&amp;display=swap" rel="stylesheet">
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    .font-romantic { font-family: 'Dancing Script', cursive; }
    .font-elegant { font-family: 'Playfair Display', serif; }
    
    /* Estrellas animadas */
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    
    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite ease-in-out;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    
    /* Coraz√≥n principal */
    .heart-container {
      position: relative;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .heart-container:hover {
      transform: scale(1.1);
    }
    
    .heart {
      width: 150px;
      height: 150px;
      animation: heartbeat 1.5s infinite ease-in-out;
      filter: drop-shadow(0 0 30px rgba(255, 100, 150, 0.8));
    }
    
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      15% { transform: scale(1.15); }
      30% { transform: scale(1); }
      45% { transform: scale(1.1); }
    }
    
    /* Part√≠culas de corazones */
    .particle {
      position: absolute;
      pointer-events: none;
      animation: float-up 3s forwards ease-out;
    }
    
    @keyframes float-up {
      0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
      100% { opacity: 0; transform: translateY(-400px) scale(0.5) rotate(360deg); }
    }
    
    /* Carta */
    .letter-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s ease;
      z-index: 100;
    }
    
    .letter-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .letter {
      background: linear-gradient(145deg, #fff5f5, #ffe4e6);
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      position: relative;
      transform: scale(0.5) rotateY(90deg);
      transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      box-shadow: 
        0 25px 50px rgba(255, 100, 150, 0.3),
        inset 0 0 100px rgba(255, 200, 200, 0.3);
    }
    
    .letter-overlay.active .letter {
      transform: scale(1) rotateY(0deg);
    }
    
    .letter::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 3px solid transparent;
      border-image: linear-gradient(45deg, #ff6b9d, #ff8fab, #ffc2d1, #ff8fab, #ff6b9d) 1;
      border-radius: 25px;
      pointer-events: none;
    }
    
    /* Decoraciones de la carta */
    .corner-decoration {
      position: absolute;
      width: 60px;
      height: 60px;
      opacity: 0.6;
    }
    
    .corner-tl { top: 10px; left: 10px; }
    .corner-tr { top: 10px; right: 10px; transform: scaleX(-1); }
    .corner-bl { bottom: 10px; left: 10px; transform: scaleY(-1); }
    .corner-br { bottom: 10px; right: 10px; transform: scale(-1); }
    
    /* √Ålbum de fotos */
    .album-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 5, 20, 0.98);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s ease;
      z-index: 200;
    }
    
    .album-container.active {
      opacity: 1;
      visibility: visible;
    }
    
    .album-book {
      perspective: 2000px;
      width: 340px;
      height: 450px;
      position: relative;
    }
    
    .album-page {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #fdf2f8, #fce7f3);
      border-radius: 5px 20px 20px 5px;
      box-shadow: 
        5px 5px 20px rgba(0,0,0,0.3),
        inset -5px 0 15px rgba(0,0,0,0.05);
      transform-origin: left center;
      transition: transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
      backface-visibility: hidden;
      display: flex;
      flex-direction: column;
      padding: 25px;
      overflow: hidden;
    }
    
    .album-page.flipped {
      transform: rotateY(-180deg);
    }
    
    .album-page::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 30px;
      background: linear-gradient(90deg, rgba(0,0,0,0.1), transparent);
    }
    
    .photo-frame {
      background: white;
      padding: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      margin-bottom: 15px;
      transform: rotate(-2deg);
      transition: transform 0.3s ease;
    }
    .photo-frame img {
      width: 100%;
      height: 180px;
      object-fit: cover; 
      object-position: center;
      border-radius: 10px;
      display: block;
      background: #fdf2f8;
    }
    
    .photo-frame:nth-child(even) {
      transform: rotate(2deg);
    }
    
    .photo-placeholder {
      width: 100%;
      height: 180px;
      background: linear-gradient(135deg, #fecdd3, #fda4af);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    
    .photo-placeholder::after {
      content: 'üì∑';
      font-size: 40px;
      opacity: 0.5;
    }
    
    .photo-caption {
      text-align: center;
      padding: 10px 5px 5px;
      color: #831843;
      font-size: 14px;
    }
    /* Solo para la imagen especial imagecopy.png */
.photo-contain {
  object-fit: contain !important;
  background: linear-gradient(135deg, #fecdd3, #fda4af); /* Fondo suave para los bordes */
  padding: 6px; /* Opcional: peque√±o margen interno */
  transition: box-shadow 0.3s;
  box-shadow: 0 2px 16px rgba(236, 72, 153, 0.13);
}
    
    /* Navegaci√≥n del √°lbum */
    .album-nav {
      display: flex;
      gap: 20px;
      margin-top: 30px;
    }
    
    .nav-btn {
      background: linear-gradient(135deg, #ec4899, #be185d);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      box-shadow: 0 5px 20px rgba(236, 72, 153, 0.4);
    }
    
    .nav-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(236, 72, 153, 0.6);
    }
    
    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .page-indicator {
      color: #fda4af;
      font-size: 14px;
      margin-top: 15px;
    }
    
    /* Bot√≥n cerrar */
    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      transition: all 0.3s ease;
    }
    
    .close-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: rotate(90deg);
    }
    
    /* Texto flotante */
    .floating-text {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    /* Nebulosa de fondo */
    .nebula {
      position: fixed;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.3;
      pointer-events: none;
    }
    
    .nebula-1 {
      top: 10%;
      left: 10%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, #ec4899, transparent);
      animation: pulse-nebula 8s infinite ease-in-out;
    }
    
    .nebula-2 {
      bottom: 20%;
      right: 15%;
      width: 250px;
      height: 250px;
      background: radial-gradient(circle, #8b5cf6, transparent);
      animation: pulse-nebula 10s infinite ease-in-out reverse;
    }
    
    @keyframes pulse-nebula {
      0%, 100% { transform: scale(1); opacity: 0.3; }
      50% { transform: scale(1.2); opacity: 0.5; }
    }
    
    /* Destellos en el coraz√≥n */
    .sparkle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: white;
      border-radius: 50%;
      animation: sparkle-anim 2s infinite;
    }
    
    @keyframes sparkle-anim {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    /* Globos con forma de coraz√≥n */
    .balloons-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 50;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-content: flex-start;
      gap: 16px 12px;
      padding: 90px 20px 20px;
      box-sizing: border-box;
    }
    
    .balloons-container.active {
      opacity: 1;
      visibility: visible;
    }
    
    .heart-balloon {
      position: relative;
      cursor: pointer;
      pointer-events: all;
      animation: rise-up 3s ease-out forwards;
      filter: drop-shadow(0 5px 20px rgba(255, 100, 150, 0.6));
      width: 80px;
      height: 110px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    @keyframes rise-up {
      0% {
        transform: translateY(100%) scale(0.3) rotate(0deg);
        opacity: 0;
      }
      20% {
        opacity: 1;
      }
      100% {
        transform: translateY(0) scale(1) rotate(var(--rotate));
        opacity: 1;
      }
    }
    
    .heart-balloon.floating {
      animation: float-gentle 4s ease-in-out infinite;
    }
    
    @keyframes float-gentle {
      0%, 100% { transform: translateY(0) rotate(var(--rotate)); }
      50% { transform: translateY(-20px) rotate(calc(var(--rotate) + 5deg)); }
    }
    
    .heart-balloon.popped {
      animation: pop-heart 0.6s forwards;
    }
    
    @keyframes pop-heart {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.3); }
      100% { transform: scale(0); opacity: 0; }
    }
    
    .heart-balloon svg {
      width: 80px;
      height: 80px;
    }

    @media (max-width: 640px) {
      .balloons-container {
        gap: 8px 4px;
        padding: 40px 4vw 8px 4vw;
        flex-wrap: wrap;
        justify-content: center;
        align-content: flex-start;
        min-width: 0;
        max-width: 100vw;
      }

      .heart-balloon {
        width: 48px;
        height: 72px;
        margin: 0 2px;
      }

      .heart-balloon svg {
        width: 48px;
        height: 48px;
      }

      .balloon-letter-text {
        font-size: 16px;
      }

      .balloon-string {
        height: 28px;
        bottom: -28px;
      }
    }
    
    .balloon-letter-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -55%);
      font-size: 28px;
      font-weight: bold;
      color: white;
      text-shadow: 0 2px 8px rgba(0,0,0,0.4);
      pointer-events: none;
    }
    
    .balloon-string {
      position: absolute;
      bottom: -50px;
      left: 50%;
      width: 2px;
      height: 50px;
      background: rgba(255, 255, 255, 0.4);
      transform: translateX(-50%);
      pointer-events: none;
    }
    
    /* Personajes flotantes */
    .characters-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 6;
    }
    
    .character {
      position: absolute;
      cursor: pointer;
      pointer-events: all;
      transition: transform 0.3s ease;
      animation: float-character 5s ease-in-out infinite;
      filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
    }
    
    .character:hover {
      transform: scale(1.15) rotate(5deg);
      animation-play-state: paused;
    }
    
    .character:active {
      transform: scale(0.95);
    }
    
    @keyframes float-character {
      0%, 100% { transform: translateY(0) rotate(-3deg); }
      50% { transform: translateY(-30px) rotate(3deg); }
    }
    
    .character.bounce {
      animation: bounce-character 0.6s ease-out;
    }
    
    @keyframes bounce-character {
      0%, 100% { transform: translateY(0) scale(1); }
      30% { transform: translateY(-40px) scale(1.1); }
      50% { transform: translateY(-20px) scale(1.05); }
      70% { transform: translateY(-10px) scale(1.02); }
    }
    
    /* Anillo brillante del coraz√≥n */
    .heart-glow-ring {
      position: absolute;
      width: 200px;
      height: 200px;
      border-radius: 50%;
      border: 3px solid rgba(255, 107, 157, 0.3);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: pulse-ring 2s ease-in-out infinite;
    }
    
    @keyframes pulse-ring {
      0%, 100% { 
        transform: translate(-50%, -50%) scale(0.9);
        opacity: 0.5;
      }
      50% { 
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 0.8;
      }
    }
    
    /* Mejora de part√≠culas */
    .emoji-particle {
      position: fixed;
      pointer-events: none;
      font-size: 30px;
      z-index: 1000;
      animation: emoji-burst 2s forwards ease-out;
    }
    
    @keyframes emoji-burst {
      0% { opacity: 1; transform: translate(0, 0) rotate(0deg) scale(1); }
      100% { opacity: 0; transform: translate(var(--tx), var(--ty)) rotate(360deg) scale(0.3); }
    }

    /* Contador regresivo */
    .countdown-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 80;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease;
    }
    
    .countdown-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .countdown-number {
      font-size: 120px;
      font-weight: bold;
      color: #ff6b9d;
      text-shadow: 0 0 40px rgba(255, 107, 157, 0.8);
      animation: countdown-pulse 1s ease-out;
    }
    
    @keyframes countdown-pulse {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }
      .volver-inicio{
    position: fixed;
    top: 14px;
    left: 14px;
    z-index: 9999;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    border-radius: 999px;
    background: rgba(0,0,0,.40);
    border: 1px solid rgba(255,255,255,.18);
    color: #fff;
    text-decoration: none;
    font-weight: 700;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .volver-inicio:hover{ transform: translateY(-1px); background: rgba(0,0,0,.52); }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gradient-to-b from-slate-950 via-purple-950 to-slate-950 overflow-auto"><!-- Estrellas de fondo -->
      <a class="volver-inicio" href="../index.html" aria-label="Volver al inicio">‚Üê </a>

  <div class="stars" id="stars"></div><!-- Nebulosas -->
  <div class="nebula nebula-1"></div>
  <div class="nebula nebula-2"></div><!-- Globos con forma de coraz√≥n (aparecen despu√©s del click) -->
  <div class="balloons-container" id="balloonsContainer"></div><!-- Contador regresivo -->
  <div class="countdown-overlay" id="countdownOverlay">
   <div class="countdown-number font-romantic" id="countdownNumber"></div>
   <p class="text-pink-300 text-2xl font-romantic mt-4">Preparando tu sorpresa...</p>
  </div><!-- Personajes flotantes -->
  <div class="characters-container" id="charactersContainer"></div><!-- Contenido principal -->
  <div class="h-full flex flex-col items-center justify-center p-8 relative z-10"><!-- T√≠tulo -->
   <h1 id="main-title" class="font-romantic text-5xl md:text-7xl text-pink-300 mb-4 floating-text text-center drop-shadow-lg">Feliz San Valent√≠n</h1>
   <p class="text-pink-200/70 font-elegant text-lg mb-12 text-center">Toca el coraz√≥n para tu sorpresa ‚ú®</p><!-- Coraz√≥n interactivo -->
   <div class="heart-container" id="heartContainer">
    <div class="heart-glow-ring"></div>
    <svg class="heart" viewbox="0 0 100 100"><defs>
      <lineargradient id="heartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
       <stop offset="0%" style="stop-color:#ff6b9d" />
       <stop offset="50%" style="stop-color:#ff4081" />
       <stop offset="100%" style="stop-color:#e91e63" />
      </lineargradient>
      <filter id="glow">
       <fegaussianblur stddeviation="2" result="coloredBlur" />
       <femerge>
        <femergenode in="coloredBlur" />
        <femergenode in="SourceGraphic" />
       </femerge>
      </filter>
     </defs> <path fill="url(#heartGradient)" filter="url(#glow)" d="M50 88.9C25 71.5 5 53.8 5 35.5 5 20.1 17.1 8 32.5 8c8.5 0 16.7 4.1 17.5 4.5.8-.4 9-4.5 17.5-4.5C82.9 8 95 20.1 95 35.5c0 18.3-20 36-45 53.4z" />
    </svg><!-- Destellos --> <span class="sparkle" style="top: 20%; left: 30%; animation-delay: 0s;"></span> <span class="sparkle" style="top: 40%; left: 70%; animation-delay: 0.5s;"></span> <span class="sparkle" style="top: 60%; left: 25%; animation-delay: 1s;"></span> <span class="sparkle" style="top: 30%; right: 20%; animation-delay: 1.5s;"></span> <span class="sparkle" style="bottom: 30%; left: 40%; animation-delay: 2s;"></span>
   </div>
   <p class="text-pink-300/50 text-sm mt-8 font-elegant">~ Hecho con amor ~</p>
  </div><!-- Overlay de la carta -->
  <div class="letter-overlay" id="letterOverlay"><button class="close-btn" id="closeLetter">‚úï</button>
   <div class="letter"><!-- Decoraciones de esquinas -->
    <svg class="corner-decoration corner-tl" viewbox="0 0 100 100"><path fill="#fda4af" d="M10,50 Q10,10 50,10 Q30,30 30,50 Q30,30 10,50" /> <circle cx="50" cy="10" r="5" fill="#fb7185" /> <circle cx="10" cy="50" r="5" fill="#fb7185" />
    </svg>
    <svg class="corner-decoration corner-tr" viewbox="0 0 100 100"><path fill="#fda4af" d="M10,50 Q10,10 50,10 Q30,30 30,50 Q30,30 10,50" /> <circle cx="50" cy="10" r="5" fill="#fb7185" /> <circle cx="10" cy="50" r="5" fill="#fb7185" />
    </svg>
    <svg class="corner-decoration corner-bl" viewbox="0 0 100 100"><path fill="#fda4af" d="M10,50 Q10,10 50,10 Q30,30 30,50 Q30,30 10,50" /> <circle cx="50" cy="10" r="5" fill="#fb7185" /> <circle cx="10" cy="50" r="5" fill="#fb7185" />
    </svg>
    <svg class="corner-decoration corner-br" viewbox="0 0 100 100"><path fill="#fda4af" d="M10,50 Q10,10 50,10 Q30,30 30,50 Q30,30 10,50" /> <circle cx="50" cy="10" r="5" fill="#fb7185" /> <circle cx="10" cy="50" r="5" fill="#fb7185" />
    </svg><!-- Contenido de la carta -->
    <div class="text-center">
     <div class="text-4xl mb-4">
      üíå
     </div>
     <h2 id="card-title" class="font-romantic text-4xl text-pink-600 mb-6">Para mi amor</h2>
     <div class="w-16 h-0.5 bg-gradient-to-r from-transparent via-pink-400 to-transparent mx-auto mb-6"></div>
     <p id="card-message" class="font-elegant text-gray-700 text-lg leading-relaxed mb-6">Cada momento a tu lado es un regalo del universo. Eres la estrella m√°s brillante de mi cielo, la raz√≥n de mis sonrisas y el amor de mi vida.</p>
     <div class="flex justify-center gap-2 text-2xl mb-6"><span class="animate-pulse">üíï</span> <span class="animate-pulse" style="animation-delay: 0.2s">‚ú®</span> <span class="animate-pulse" style="animation-delay: 0.4s">üíï</span>
     </div>
     <p id="card-signature" class="font-romantic text-2xl text-pink-500">Con todo mi amor</p><button id="openAlbum" class="mt-6 bg-gradient-to-r from-pink-500 to-rose-500 text-white px-8 py-3 rounded-full font-elegant hover:from-pink-600 hover:to-rose-600 transition-all duration-300 shadow-lg hover:shadow-xl hover:-translate-y-1"> Ver √Ålbum de Fotos üìñ </button>
    </div>
   </div>
  </div><!-- √Ålbum de fotos -->
  <div class="album-container" id="albumContainer"><button class="close-btn" id="closeAlbum">‚úï</button>
   <h2 class="font-romantic text-4xl text-pink-300 mb-8">Nuestros Momentos üíù</h2>
   <div class="album-book" id="albumBook"></div>
   <div class="album-nav"><button class="nav-btn" id="prevPage">‚Üê Anterior</button> <button class="nav-btn" id="nextPage">Siguiente ‚Üí</button>
   </div>
   <p class="page-indicator font-elegant" id="pageIndicator">P√°gina 1 de 4</p>
  </div>
  <script>
    // Configuraci√≥n por defecto
    const defaultConfig = {
      person_name: 'Titii',
      card_title: 'Para mi amor',
      card_message: 'Cada momento a tu lado es un regalo del universo. Eres la estrella m√°s brillante de mi cielo, la raz√≥n de mis sonrisas y el amor de mi vida.',
      signature: 'Con todo mi amor',
      primary_color: '#ec4899',
      secondary_color: '#fda4af',
      text_color: '#831843',
      background_color: '#0f0a1e',
      accent_color: '#8b5cf6'
    };

    let config = { ...defaultConfig };
    let heartClicked = false;

    // Crear estrellas
    function createStars() {
      const starsContainer = document.getElementById('stars');
      for (let i = 0; i < 150; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        const size = Math.random() * 3 + 1;
        star.style.width = size + 'px';
        star.style.height = size + 'px';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
      }
    }
    
    createStars();

    // Crear globos con forma de coraz√≥n
    function createHeartBalloons() {
      const balloonsContainer = document.getElementById('balloonsContainer');
      balloonsContainer.innerHTML = '';
      
      const personName = config.person_name || defaultConfig.person_name;
      const message = `TE AMO ${personName.toUpperCase()}`;
      const letters = message.split('');
      
      const colors = ['#ff6b9d', '#ff4081', '#e91e63', '#f06292', '#ec407a', '#ff80ab'];
      
      letters.forEach((letter, i) => {
        const balloon = document.createElement('div');
        balloon.className = 'heart-balloon';
        
        const rotation = (Math.random() - 0.5) * 15;
        balloon.style.setProperty('--rotate', rotation + 'deg');
        balloon.style.animationDelay = (i * 0.15) + 's';
        
        const color = colors[i % colors.length];
        
        if (letter === ' ') {
          balloon.style.opacity = '0';
          balloon.style.pointerEvents = 'none';
        } else {
          balloon.innerHTML = `
            <svg viewBox="0 0 100 100">
              <defs>
                <linearGradient id="grad${i}" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:${color};stop-opacity:1" />
                  <stop offset="100%" style="stop-color:${adjustBrightness(color, -20)};stop-opacity:1" />
                </linearGradient>
                <filter id="shadow${i}">
                  <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
                  <feOffset dx="0" dy="3" result="offsetblur"/>
                  <feComponentTransfer>
                    <feFuncA type="linear" slope="0.5"/>
                  </feComponentTransfer>
                  <feMerge>
                    <feMergeNode/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>
              <path fill="url(#grad${i})" filter="url(#shadow${i})" d="M50 88.9C25 71.5 5 53.8 5 35.5 5 20.1 17.1 8 32.5 8c8.5 0 16.7 4.1 17.5 4.5.8-.4 9-4.5 17.5-4.5C82.9 8 95 20.1 95 35.5c0 18.3-20 36-45 53.4z"/>
            </svg>
            <div class="balloon-letter-text font-romantic">${letter}</div>
            <div class="balloon-string"></div>
          `;
          
          setTimeout(() => {
            balloon.classList.add('floating');
          }, 3000 + (i * 150));
          
          balloon.addEventListener('click', function() {
            this.classList.add('popped');
            createEmojiBurst(
              this.offsetLeft + this.offsetWidth / 2,
              this.offsetTop + this.offsetHeight / 2,
              ['üíï', '‚ú®', 'üíñ', '‚≠ê', 'üíó', 'üíù']
            );
            setTimeout(() => this.remove(), 600);
          });
        }
        
        balloonsContainer.appendChild(balloon);
      });
      
      balloonsContainer.classList.add('active');
    }

    // Funci√≥n auxiliar para ajustar brillo
    function adjustBrightness(hex, percent) {
      const num = parseInt(hex.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = (num >> 16) + amt;
      const G = (num >> 8 & 0x00FF) + amt;
      const B = (num & 0x0000FF) + amt;
      return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
        (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
        (B < 255 ? B < 1 ? 0 : B : 255))
        .toString(16).slice(1);
    }

    // Crear personajes animados
    function createCharacters() {
      const charactersContainer = document.getElementById('charactersContainer');
      const characters = [
        { emoji: 'üíó', text: 'Hello Kitty', top: '25%', left: '10%', delay: '0s' },
        { emoji: 'üíó', text: 'Spider-Man', top: '60%', left: '85%', delay: '1s' },
        { emoji: 'üíó', text: 'Unicornio', top: '70%', left: '15%', delay: '0.5s' },
        { emoji: 'üå∏', text: 'Panda', top: '30%', left: '80%', delay: '1.5s' },
        { emoji: 'üå∏', text: 'Sakura', top: '50%', left: '5%', delay: '2s' },
        { emoji: 'üå∏', text: 'Estrella', top: '80%', left: '75%', delay: '0.8s' }
      ];
      
      characters.forEach((char) => {
        const character = document.createElement('div');
        character.className = 'character';
        character.style.top = char.top;
        character.style.left = char.left;
        character.style.fontSize = '50px';
        character.style.animationDelay = char.delay;
        character.textContent = char.emoji;
        character.title = char.text;
        
        character.addEventListener('click', function() {
          this.classList.add('bounce');
          createEmojiBurst(
            this.offsetLeft + this.offsetWidth / 2,
            this.offsetTop + this.offsetHeight / 2,
            ['üíù', 'üíò', 'üíï', '‚ú®', 'üåü', 'üí´']
          );
          setTimeout(() => this.classList.remove('bounce'), 600);
        });
        
        charactersContainer.appendChild(character);
      });
    }

    createCharacters();

    // Crear explosi√≥n de emojis
    function createEmojiBurst(x, y, emojis) {
      const count = 12;
      for (let i = 0; i < count; i++) {
        const particle = document.createElement('div');
        particle.className = 'emoji-particle';
        particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        
        const angle = (Math.PI * 2 * i) / count;
        const distance = 100 + Math.random() * 50;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.setProperty('--tx', `${tx}px`);
        particle.style.setProperty('--ty', `${ty}px`);
        
        document.body.appendChild(particle);
        setTimeout(() => particle.remove(), 2000);
      }
    }

    // Contador regresivo
    function startCountdown() {
      const countdownOverlay = document.getElementById('countdownOverlay');
      const countdownNumber = document.getElementById('countdownNumber');
      
      countdownOverlay.classList.add('active');
      
      let count = 3;
      countdownNumber.textContent = count;
      
      const interval = setInterval(() => {
        count--;
        if (count > 0) {
          countdownNumber.textContent = count;
          countdownNumber.style.animation = 'none';
          setTimeout(() => {
            countdownNumber.style.animation = 'countdown-pulse 1s ease-out';
          }, 10);
        } else {
          clearInterval(interval);
          countdownOverlay.classList.remove('active');
          setTimeout(() => {
            document.getElementById('letterOverlay').classList.add('active');
          }, 500);
        }
      }, 1000);
    }

    // Evento del coraz√≥n
    const heartContainer = document.getElementById('heartContainer');
    
    heartContainer.addEventListener('click', function(e) {
      if (heartClicked) return;
      heartClicked = true;
      
      const rect = this.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      
      for (let i = 0; i < 20; i++) {
        setTimeout(() => {
          const offsetX = (Math.random() - 0.5) * 150;
          const offsetY = (Math.random() - 0.5) * 150;
          createEmojiBurst(centerX + offsetX, centerY + offsetY, ['üíï', 'üíñ', 'üíó', '‚ú®', 'üíù']);
        }, i * 30);
      }
      
      setTimeout(() => {
        createHeartBalloons();
        
        setTimeout(() => {
          startCountdown();
        }, 4000);
      }, 500);
    });

    // Cerrar carta
    document.getElementById('closeLetter').addEventListener('click', function() {
      document.getElementById('letterOverlay').classList.remove('active');
    });

    // √Ålbum de fotos
    // AGREGA AQU√ç TUS FOTOS Y DESCRIPCIONES
    const albumData = [
      { img: 'image1.png', caption: 'Momento juntos üíï' },
      { img: 'image.png', caption: 'Esa sonrisa que me enamora ‚ú®' },
      { img: 'image2.png', caption: 'Aventuras inolvidables üåü' },
      { img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQfgxbe82Wpg5wzjM0WpHo3WQJ2mXR2GavvCw&s', caption: 'Siempre juntos üíù' },
      { img: 'image3.png', caption: 'Siempre juntos üíù' },
      { img: 'https://wallpapers.com/images/featured/fondo-de-pantalla-de-san-valentin-p16yhekd7g3u2rz5.jpg', caption: 'Siempre juntos üíù' },
      { img: 'imagecopy.png', caption: 'Siempre juntos üíù' },
      { img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYNihQIugfTQyOxmzNYBOfIPqyC_1-GxxxRw&s', caption: 'Siempre juntos üíù' }
    ];

    let currentPage = 0;
    const totalPages = 4;

    function createAlbumPages() {
      const albumBook = document.getElementById('albumBook');
      albumBook.innerHTML = '';
      const fotosPorPagina = 2;
      for (let i = 0; i < totalPages; i++) {
        const page = document.createElement('div');
        page.className = 'album-page';
        page.style.zIndex = totalPages - i;
        const photoIndex1 = i * fotosPorPagina;
        const photoIndex2 = i * fotosPorPagina + 1;
        page.innerHTML = `
          <div class="photo-frame">
            ${albumData[photoIndex1]?.img ? `<img src="${albumData[photoIndex1].img}" alt="foto" ${albumData[photoIndex1].img === 'imagecopy.png' ? 'class="photo-contain"' : ''} />` : '<div class="photo-placeholder"></div>'}
            <p class="photo-caption font-romantic">${albumData[photoIndex1]?.caption || 'Tu foto aqu√≠'}</p>
          </div>
          <div class="photo-frame">
            ${albumData[photoIndex2]?.img ? `<img src="${albumData[photoIndex2].img}" alt="foto" ${albumData[photoIndex2].img === 'imagecopy.png' ? 'class="photo-contain"' : ''} />` : '<div class="photo-placeholder"></div>'}
            <p class="photo-caption font-romantic">${albumData[photoIndex2]?.caption || 'Tu foto aqu√≠'}</p>
          </div>
          <p class="text-center text-pink-400 font-romantic text-sm mt-auto">~ P√°gina ${i + 1} ~</p>
        `;
        albumBook.appendChild(page);
      }
      updatePageButtons();
    }

    function updatePageButtons() {
      document.getElementById('prevPage').disabled = currentPage === 0;
      document.getElementById('nextPage').disabled = currentPage >= totalPages - 1;
      document.getElementById('pageIndicator').textContent = `P√°gina ${currentPage + 1} de ${totalPages}`;
    }

    function flipPage(direction) {
      const pages = document.querySelectorAll('.album-page');
      
      if (direction === 'next' && currentPage < totalPages - 1) {
        pages[currentPage].classList.add('flipped');
        currentPage++;
      } else if (direction === 'prev' && currentPage > 0) {
        currentPage--;
        pages[currentPage].classList.remove('flipped');
      }
      
      updatePageButtons();
    }

    document.getElementById('nextPage').addEventListener('click', () => flipPage('next'));
    document.getElementById('prevPage').addEventListener('click', () => flipPage('prev'));

    // Abrir √°lbum
    document.getElementById('openAlbum').addEventListener('click', function() {
      document.getElementById('letterOverlay').classList.remove('active');
      setTimeout(() => {
        document.getElementById('albumContainer').classList.add('active');
        createAlbumPages();
      }, 300);
    });

    // Cerrar √°lbum
    document.getElementById('closeAlbum').addEventListener('click', function() {
      document.getElementById('albumContainer').classList.remove('active');
      currentPage = 0;
    });

    // Funci√≥n para actualizar la UI
    async function onConfigChange(cfg) {
      config = { ...defaultConfig, ...cfg };
      
      document.getElementById('card-title').textContent = config.card_title || defaultConfig.card_title;
      document.getElementById('card-message').textContent = config.card_message || defaultConfig.card_message;
      document.getElementById('card-signature').textContent = config.signature || defaultConfig.signature;
    }

    // Mapeo de capacidades
    function mapToCapabilities(cfg) {
      return {
        recolorables: [
          {
            get: () => cfg.background_color || defaultConfig.background_color,
            set: (value) => { cfg.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
          },
          {
            get: () => cfg.primary_color || defaultConfig.primary_color,
            set: (value) => { cfg.primary_color = value; window.elementSdk.setConfig({ primary_color: value }); }
          },
          {
            get: () => cfg.secondary_color || defaultConfig.secondary_color,
            set: (value) => { cfg.secondary_color = value; window.elementSdk.setConfig({ secondary_color: value }); }
          },
          {
            get: () => cfg.text_color || defaultConfig.text_color,
            set: (value) => { cfg.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
          },
          {
            get: () => cfg.accent_color || defaultConfig.accent_color,
            set: (value) => { cfg.accent_color = value; window.elementSdk.setConfig({ accent_color: value }); }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    // Mapeo para el panel de edici√≥n
    function mapToEditPanelValues(cfg) {
      return new Map([
        ['person_name', cfg.person_name || defaultConfig.person_name],
        ['card_title', cfg.card_title || defaultConfig.card_title],
        ['card_message', cfg.card_message || defaultConfig.card_message],
        ['signature', cfg.signature || defaultConfig.signature]
      ]);
    }

    // Inicializar SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c8d020593461a73',t:'MTc3MDIzNzg4Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>